### Описание

**emload** - команда для добавления торрента в клиент и автоматической каталогизации с использованием так называемой ссылочной схемы, когда данные хранятся в специально отведенном каталоге, а коллекция составляется из папок и символических ссылок на данные. Как именно это работает, проще всего объяснить на примере любого торрент-файла.

Скажем, если у вас имеется торрент `revolution_os.torrent`, содержащий файл `Revolution OS.mkv`, а в качестве клиента используется [rTorrent](/clients#rtorrent), вы можете загрузить свой торрент-файл следующим образом:

```bash
$ emload revolution_os.torrent --link-to /srv/collection/Фильмы/Документальные/Революционная\ ОС --set-customs c1=documentary
```

В этом случае **emload** выполнит следующие действия:

  1. Создаст подкаталог в `core/data_root_dir`, содержащий в названии имя торрент-файла. Если этот [параметр](/config) равен `/srv/torrents`, то будет создан такой каталог: `/srv/torrents/r/revolution_os.torrent.data`.
  2. Зная, что торрент предоставляет файл `Revolution OS.mkv`, программа создаст каталог `/srv/collection/Фильмы/Документальные/Революционная ОС` и разместит в нем ссылку `Revolution OS.mkv`, указывающую на `/srv/torrents/r/revolution_os.torrent.data/Revolution OS.mkv`.
  3. Добавит в клиент торрент с указанием каталога для скачки, созданного в первом пункте.
  4. Назначит на торрент [метку](/clients#rtorrent) `documentary`.

Если указан относительный путь к торрент-файлу, **emload** попытается найти его в каталоге, указанном параметром `core/torrents_dir` в конфигурации. Подробнее об этом смотрите на странице [config](/config). Кроме того, **emload** загружает торрент только по данным, т.е. клиент не будет ничего знать о расположении торрент-файла. Это очень удобно для систем, где клиент находится на виртуалке, а торренты лежат на хосте.


***
### Опции

{!_stdopts.md!}

* **`-v, --verbose`**
    * Включает отладочные сообщения, направляемые в stderr.

* **`-l, --link-to <path/to/dir>`**
    * Создает символическую ссылку на данные торрента в указанном месте. Если торрент предоставляет файл, то будет создан полный запрошенный путь, а в последний его компонент (каталог) будет помещена ссылка с именем файла, как внутри торрента, указывающая на данные. Если же торрент предоставляет каталог, то последний компонент пути будет сам являться ссылкой на данные. Эта опция работает только если вы указываете для **emload** один торрент-файл. Если целевая ссылка уже существует, то **emload** завершится с ошибкой.

* **`--set-customs <key=value> ...`**
    * Присваивает [кастомным полям клиента](/clients) для загружаемых торрентов определенные значения.


***
### Конфигурационные параметры

Общие параметры и способ настройки описаны на странице [config](/config), здесь же приведены специфические параметры программы.

* **`emload/mkdir_mode=""`**
    * Восьмеричные права доступа на последний из дерева создаваемых каталогов для данных и ссылок.

* **`emload/set_customs={}`**
    * Назначает загруженным торрентам значения кастомных полей. Перезаписывается соответствующей опцией. Поддерживает питоновые [форматтеры времени](/http://docs.python.org/3/library/datetime.html#strftime-strptime-behavior). Например, следующая конфигурация заставит **emload** при использовании **ruTorrent** назначить метку `new` на все новые загрузки:
  ```yaml
  emload:
      set_customs:
          c1: new
  ```


***
### Примеры использования

Загрузить один торрент:

```bash
$ emload foo.torrent
```

Загрузить несколько торрентов и назначить на них метку:

```bash
$ emload foo.torrent bar.torrent --set-customs c1=yay
```

Загрузить торрент и создать ссылку:

```bash
$ emload foo.torrent --link-to ~/Foo
```
